# 后端架构文档

## 包结构
本文档中，指代包名时省略前缀 `java.writo.terminal.`.

1. config

    包含跨域连接配置类。
    
1. contract

    包含通用接口信息。
    
1. controller

    控制器层，前后端交互接口，在本架构中承担主要业务逻辑。
    
1. core

    后端内核，负责接口管理与服务层和数据持久层功能的代理。
    
1. data

    数据持久层对象，用于直接与数据库交互。

1. service

    服务层实现，提供较复杂功能的封装（如登录用例包含的 Redis 缓存）。

1. type

    枚举类集合。

1. util

    结构辅助类型，包括前后端交互封装类，测试状态注解，树状结构存储。

1. view

    数据展示层对象，通常作为交互封装类内的数据字段传递。

## 设计考虑

由于本项目具有规模较小，业务逻辑相对简单的特点，我们对传统的三层架构作出了一定的修改。

我们设计了后端内核，其作为代理，像控制器层提供后端的各类服务。我们利用控制反转，由内核管理所有接口，并将对应实现分散到对应包中，确保了单向依赖。控制器基类持有对内核的引用，因此可以方便地调用各层级接口。在实践中，我们使用控制器层作为胶水粘合后端各层服务，导致控制器层对后端服务的依赖相对原三层架构略强，但考虑到项目本身规模不大且有内核提供接口以允许实现的修改，我们认为这个影响是可接受的。另一方面，直接接触内核使得功能的实现不需要经过多层传递，同时提升了开发效率和项目性能。另外，我们压缩了三层架构中的业务逻辑层，将仅有的业务逻辑直接在控制器层中实现，服务层只提供与业务逻辑弱相关的功能实现。这一改动的合理性建立在业务逻辑本身的清晰上，得到的收益是系统架构的进一步简化。

![](https://name-not-defined.oss-cn-shanghai.aliyuncs.com/writo_struct.png)

